{% extends 'base_site.html' %}

{% block content %}
<!-- Derniers messages --> 
            <div class="row mt-4"> 
                <div class="col-12"> 
                    <div class="card"> 
                        <div class="card-header bg-warning text-dark"> 
                            <h5 class="mb-0"> 
                                <i class="fas fa-clock"></i> Tous les messages 
                            </h5> 
                        </div> 
                        <div class="card-body"> 
                            {% if all_messages %}
                            <div class="table-responsive">
                                <table class="table table-striped table-hover align-middle">
                                    <thead>
                                        <tr class="text-center">
                                            <th>Nom & Prénom</th>
                                            <th>Email</th>
                                            <th>Téléphone</th>
                                            <th>Entreprise</th>
                                            <th>Service</th>
                                            <th>Message</th>
                                            <th>Budget</th>
                                            <th>Newsletter</th>
                                            <th>Lu</th>
                                            <th>Date</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for message in all_messages %}
                                        <tr class="text-center">
                                            <td class="text-start"><a href="{% url 'message_read' message.pk %}" class="text-decoration-none">{{ message.firstName }} {{ message.lastName }}</a></td>
                                            <td>{{ message.email }}</td>
                                            <td>{{ message.phone|default:'-' }}</td>
                                            <td>{{ message.company|default:'-' }}</td>
                                            <td>{{ message.service|truncatewords:3 }}</td>
                                            <td class="text-start">{{ message.message|truncatewords:12 }}</td>
                                            <td>{{ message.budget|default:'-' }}</td>
                                            <td>{% if message.newsletter %}<span class="badge bg-success">Oui</span>{% else %}<span class="badge bg-secondary">Non</span>{% endif %}</td>
                                            <td>{% if message.is_read %}<span class="badge bg-info text-dark">Lu</span>{% else %}<span class="badge bg-warning text-dark">Non lu</span>{% endif %}</td>
                                            <td>{{ message.created_at|date:"H:i d/m/Y" }}</td>
                                            <td>
                                                <a href="{% url 'message_read' message.pk %}" class="btn btn-sm btn-primary">Voir</a>
                                            </td>
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                            {% else %}
                            <p class="text-muted">Aucun message récent.</p>
                            {% endif %}
                        </div> 
                    </div> 
                </div> 
            </div> 
{% endblock %}